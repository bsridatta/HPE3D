diff --git a/experiments/run1.sh b/experiments/run1.sh
index f6d3c7b..8a33f0c 100644
--- a/experiments/run1.sh
+++ b/experiments/run1.sh
@@ -1,14 +1,15 @@
 python3.7 ../src/train.py \
     --cuda True\
+    --wandb True\
     --seed 400\
-    --annotation_file debug_h36m17.h5\
+    --annotation_file /home/datta/lab/HPE3D/src/data/debug_h36m17.h5\
     --image_path /home/datta/lab/HPE_datasets/h36m/\
     --ignore_images True\
     --epochs 200\
     --batch_size 5\
     --fast_dev_run True\
     --resume_pt 0\
-    --variant 1\
+    --variant 2\
     --latent_dim 30\
     --pretrained False\
     --train_last_block False\
diff --git a/experiments/run_cuda.sh b/experiments/run_cuda.sh
index 67ec0b6..3c34661 100644
--- a/experiments/run_cuda.sh
+++ b/experiments/run_cuda.sh
@@ -1,17 +1,18 @@
-python3.7 ../src/train.py \
+!python3.7 ../src/train.py \
     --cuda True\
+    --pin_memory True\
+    --wandb True\
     --seed 400\
+    --variant 2\
+    --latent_dim 50\
+    --beta 2\
     --annotation_file /kaggle/input/human36m/h36m17.h5\
     --image_path /kaggle/input/h36-images/\
     --ignore_images True\
-    --epochs 10\
-    --batch_size 256\
+    --epochs 30\
+    --batch_size 1024\
     --fast_dev_run True\
     --resume_pt 0\
-    --variant 2\
-    --latent_dim 30\
-    --beta 10**-2\
-    --pin_memory True\
     --pretrained False\
     --train_last_block False\
     --n_joints 16\
diff --git a/src/train.py b/src/train.py
index 018739f..0c8ba93 100644
--- a/src/train.py
+++ b/src/train.py
@@ -23,8 +23,6 @@ def main():
     logging.getLogger().setLevel(logging.INFO)
 
     # Tensorboard Logs
-    if config.wandb:
-        wandb.init(anonymous='allow', project="hpe", sync_tensorboard=True)
     suffix = 0
     while os.path.exists(f"{os.path.dirname(os.path.abspath(__file__))}/logs/{config.exp_name}_{suffix}"):
         suffix += 1
@@ -32,6 +30,10 @@ def main():
         f"{os.path.dirname(os.path.abspath(__file__))}/logs/{config.exp_name}_{suffix}")
     config.writer = writer
 
+
+    if config.wandb:
+        wandb.init(anonymous='allow', project="hpe", sync_tensorboard=True)
+
     # log intervals
     eval_interval = 1  # interval to get MPJPE of 3d decoder
     manifold_interval = 1  # interval to visualize encoding in manifold
diff --git a/wandb/debug.log b/wandb/debug.log
index dd77839..307e412 100644
--- a/wandb/debug.log
+++ b/wandb/debug.log
@@ -1,45 +1,47 @@
-2020-05-13 08:11:27,254 DEBUG   MainThread:13877 [wandb_config.py:_load_defaults():122] no defaults not found in config-defaults.yaml
-2020-05-13 08:11:27,262 DEBUG   MainThread:13877 [meta.py:setup():100] code probe starting
-2020-05-13 08:11:27,264 DEBUG   MainThread:13877 [meta.py:_setup_code_git():49] probe for git information
-2020-05-13 08:11:27,282 DEBUG   MainThread:13877 [meta.py:_setup_code_program():58] save program starting
-2020-05-13 08:11:27,283 DEBUG   MainThread:13877 [meta.py:_setup_code_program():60] save program starting: /home/datta/lab/HPE3D/src/train.py
-2020-05-13 08:11:27,283 DEBUG   MainThread:13877 [meta.py:_setup_code_program():68] save program saved: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/code/src/train.py
-2020-05-13 08:11:27,283 DEBUG   MainThread:13877 [meta.py:_setup_code_program():70] save program
-2020-05-13 08:11:27,284 DEBUG   MainThread:13877 [meta.py:setup():122] code probe done
-2020-05-13 08:11:27,305 DEBUG   MainThread:13877 [run_manager.py:__init__():546] Initialized sync for hpe/13kxw0pw
-2020-05-13 08:11:27,309 INFO    MainThread:13877 [run_manager.py:wrap_existing_process():1148] wrapping existing process 13850
-2020-05-13 08:11:27,309 WARNING MainThread:13877 [io_wrap.py:register():104] SIGWINCH handler was not None: <Handlers.SIG_DFL: 0>
-2020-05-13 08:11:27,377 INFO    MainThread:13877 [run_manager.py:init_run():927] system metrics and metadata threads started
-2020-05-13 08:11:27,377 INFO    MainThread:13877 [run_manager.py:init_run():966] upserting run before process can begin, waiting at most 10 seconds
-2020-05-13 08:11:27,744 INFO    Thread-14 :13877 [run_manager.py:_upsert_run():1051] saving patches
-2020-05-13 08:11:27,798 INFO    Thread-14 :13877 [run_manager.py:_upsert_run():1055] saving pip packages
-2020-05-13 08:11:27,800 INFO    Thread-14 :13877 [run_manager.py:_upsert_run():1057] initializing streaming files api
-2020-05-13 08:11:27,802 INFO    Thread-14 :13877 [run_manager.py:_upsert_run():1064] unblocking file change observer, beginning sync with W&B servers
-2020-05-13 08:11:27,803 INFO    MainThread:13877 [run_manager.py:wrap_existing_process():1165] informing user process we are ready to proceed
-2020-05-13 08:11:27,812 INFO    MainThread:13877 [run_manager.py:_sync_etc():1272] entering loop for messages from user process
-2020-05-13 08:11:27,814 INFO    MainThread:13877 [run_manager.py:_sync_etc():1295] received message from user process: {"save_policy": {"glob": "events.out.tfevents.1589350287.Datta.13850.0", "policy": "live"}}
-2020-05-13 08:11:28,264 INFO    Thread-3  :13877 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/config.yaml
-2020-05-13 08:11:28,556 INFO    Thread-3  :13877 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/code/src/train.py
-2020-05-13 08:11:28,558 INFO    Thread-3  :13877 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/requirements.txt
-2020-05-13 08:11:28,562 INFO    Thread-3  :13877 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/output.log
-2020-05-13 08:11:28,563 INFO    Thread-3  :13877 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/events.out.tfevents.1589350287.Datta.13850.0
-2020-05-13 08:11:28,564 INFO    Thread-3  :13877 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/diff.patch
-2020-05-13 08:11:28,565 INFO    Thread-3  :13877 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/wandb-metadata.json
-2020-05-13 08:11:28,567 INFO    Thread-3  :13877 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/code/src
-2020-05-13 08:11:28,568 INFO    Thread-3  :13877 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/code
-2020-05-13 08:11:28,719 INFO    MainThread:13877 [run_manager.py:_sync_etc():1295] received message from user process: {"exitcode": 0}
-2020-05-13 08:11:28,720 INFO    MainThread:13877 [run_manager.py:_sync_etc():1381] closing log streams and sending exitcode to W&B
-2020-05-13 08:11:28,720 INFO    MainThread:13877 [run_manager.py:shutdown():1071] shutting down system stats and metadata service
-2020-05-13 08:11:29,264 INFO    Thread-3  :13877 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/output.log
-2020-05-13 08:11:29,264 INFO    Thread-3  :13877 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/wandb-history.jsonl
-2020-05-13 08:11:29,266 INFO    Thread-3  :13877 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/wandb-events.jsonl
-2020-05-13 08:11:29,268 INFO    Thread-3  :13877 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/wandb-summary.json
-2020-05-13 08:11:29,384 INFO    MainThread:13877 [run_manager.py:shutdown():1085] stopping streaming files and file change observer
-2020-05-13 08:11:30,268 INFO    Thread-3  :13877 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_061126-13kxw0pw/wandb-metadata.json
-2020-05-13 08:11:31,932 INFO    MainThread:13877 [run_manager.py:_sync_etc():1400] rendering summary
-2020-05-13 08:11:31,933 INFO    MainThread:13877 [run_manager.py:_sync_etc():1433] syncing files to cloud storage
-2020-05-13 08:11:33,192 INFO    MainThread:13877 [run_manager.py:_sync_etc():1448] syncing complete: https://app.wandb.ai/b-sridatta/hpe/runs/13kxw0pw
-w/wandb-metadata.json
-2020-05-13 08:11:31,932 INFO    MainThread:13877 [13kxw0pw:run_manager.py:_sync_etc():1400] rendering summary
-2020-05-13 08:11:31,933 INFO    MainThread:13877 [13kxw0pw:run_manager.py:_sync_etc():1433] syncing files to cloud storage
-2020-05-13 08:11:33,192 INFO    MainThread:13877 [13kxw0pw:run_manager.py:_sync_etc():1448] syncing complete: https://app.wandb.ai/b-sridatta/hpe/runs/13kxw0pw
+2020-05-13 10:57:41,250 DEBUG   MainThread:24636 [wandb_config.py:_load_defaults():122] no defaults not found in config-defaults.yaml
+2020-05-13 10:57:41,255 DEBUG   MainThread:24636 [meta.py:setup():100] code probe starting
+2020-05-13 10:57:41,256 DEBUG   MainThread:24636 [meta.py:_setup_code_git():49] probe for git information
+2020-05-13 10:57:41,269 DEBUG   MainThread:24636 [meta.py:_setup_code_program():58] save program starting
+2020-05-13 10:57:41,270 DEBUG   MainThread:24636 [meta.py:_setup_code_program():60] save program starting: /home/datta/lab/HPE3D/src/train.py
+2020-05-13 10:57:41,270 DEBUG   MainThread:24636 [meta.py:_setup_code_program():68] save program saved: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/code/src/train.py
+2020-05-13 10:57:41,270 DEBUG   MainThread:24636 [meta.py:_setup_code_program():70] save program
+2020-05-13 10:57:41,271 DEBUG   MainThread:24636 [meta.py:setup():122] code probe done
+2020-05-13 10:57:41,292 DEBUG   MainThread:24636 [run_manager.py:__init__():546] Initialized sync for hpe/ekjlguab
+2020-05-13 10:57:41,295 INFO    MainThread:24636 [run_manager.py:wrap_existing_process():1148] wrapping existing process 24615
+2020-05-13 10:57:41,296 WARNING MainThread:24636 [io_wrap.py:register():104] SIGWINCH handler was not None: <Handlers.SIG_DFL: 0>
+2020-05-13 10:57:41,343 INFO    MainThread:24636 [run_manager.py:init_run():927] system metrics and metadata threads started
+2020-05-13 10:57:41,343 INFO    MainThread:24636 [run_manager.py:init_run():966] upserting run before process can begin, waiting at most 10 seconds
+2020-05-13 10:57:41,571 INFO    Thread-14 :24636 [run_manager.py:_upsert_run():1051] saving patches
+2020-05-13 10:57:41,623 INFO    Thread-14 :24636 [run_manager.py:_upsert_run():1055] saving pip packages
+2020-05-13 10:57:41,624 INFO    Thread-14 :24636 [run_manager.py:_upsert_run():1057] initializing streaming files api
+2020-05-13 10:57:41,626 INFO    Thread-14 :24636 [run_manager.py:_upsert_run():1064] unblocking file change observer, beginning sync with W&B servers
+2020-05-13 10:57:41,626 INFO    MainThread:24636 [run_manager.py:wrap_existing_process():1165] informing user process we are ready to proceed
+2020-05-13 10:57:41,632 INFO    MainThread:24636 [run_manager.py:_sync_etc():1272] entering loop for messages from user process
+2020-05-13 10:57:41,634 INFO    MainThread:24636 [run_manager.py:_sync_etc():1295] received message from user process: {"save_policy": {"glob": "events.out.tfevents.1589360260.Datta.24615.0", "policy": "live"}}
+2020-05-13 10:57:42,256 INFO    Thread-3  :24636 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/config.yaml
+2020-05-13 10:57:42,438 INFO    Thread-3  :24636 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/code/src/train.py
+2020-05-13 10:57:42,443 INFO    Thread-3  :24636 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/events.out.tfevents.1589360260.Datta.24615.0
+2020-05-13 10:57:42,444 INFO    Thread-3  :24636 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/diff.patch
+2020-05-13 10:57:42,444 INFO    Thread-3  :24636 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/output.log
+2020-05-13 10:57:42,445 INFO    Thread-3  :24636 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/requirements.txt
+2020-05-13 10:57:42,449 INFO    Thread-3  :24636 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/wandb-metadata.json
+2020-05-13 10:57:42,450 INFO    Thread-3  :24636 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/code/src
+2020-05-13 10:57:42,451 INFO    Thread-3  :24636 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/code
+2020-05-13 10:57:43,259 INFO    Thread-3  :24636 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/output.log
+2020-05-13 10:57:44,264 INFO    Thread-3  :24636 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/output.log
+2020-05-13 10:57:45,264 INFO    Thread-3  :24636 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/output.log
+2020-05-13 10:57:46,265 INFO    Thread-3  :24636 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/output.log
+2020-05-13 10:57:47,267 INFO    Thread-3  :24636 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/output.log
+2020-05-13 10:57:47,456 INFO    MainThread:24636 [run_manager.py:_sync_etc():1328] process received interrupt signal, shutting down
+2020-05-13 10:57:47,457 INFO    MainThread:24636 [run_manager.py:_sync_etc():1381] closing log streams and sending exitcode to W&B
+2020-05-13 10:57:47,464 INFO    MainThread:24636 [run_manager.py:shutdown():1071] shutting down system stats and metadata service
+2020-05-13 10:57:48,267 INFO    Thread-3  :24636 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/wandb-history.jsonl
+2020-05-13 10:57:48,272 INFO    Thread-3  :24636 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/output.log
+2020-05-13 10:57:48,273 INFO    Thread-3  :24636 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/wandb-summary.json
+2020-05-13 10:57:48,274 INFO    Thread-3  :24636 [run_manager.py:_on_file_created():680] file/dir created: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/wandb-events.jsonl
+2020-05-13 10:57:48,371 INFO    MainThread:24636 [run_manager.py:shutdown():1085] stopping streaming files and file change observer
+2020-05-13 10:57:49,268 INFO    Thread-3  :24636 [run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/wandb-metadata.json
+2020-05-13 10:57:50,613 INFO    MainThread:24636 [run_manager.py:_sync_etc():1393] process only ran for 9 seconds, not syncing files
+Thread:24636 [ekjlguab:run_manager.py:shutdown():1085] stopping streaming files and file change observer
+2020-05-13 10:57:49,268 INFO    Thread-3  :24636 [ekjlguab:run_manager.py:_on_file_modified():691] file/dir modified: /home/datta/lab/HPE3D/wandb/run-20200513_085740-ekjlguab/wandb-metadata.json
+2020-05-13 10:57:50,613 INFO    MainThread:24636 [ekjlguab:run_manager.py:_sync_etc():1393] process only ran for 9 seconds, not syncing files
